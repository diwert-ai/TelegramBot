# Как обновить python на Ubuntu
источник: https://ploshadka.net/kak-obnovit-python-na-ubuntu/

30.10.2022  Linux, Python, Ubuntu 

Обновление на новые версии это всегда «весело».  Вместе с новым функционалом понадобится убрать устаревшие функции, 
обновить потерявшие совместимость модули и в целом проделать большую работу.

Содержание:
- Подготавливаем данные с локальной версии
- Обновляем Ubuntu на сервере
- Обновляем python на сервере
- Меняем версию python в системе «по умолчанию»
- Устанавливаем новое окружение

## Подготавливаем данные с локальной версии
1. Сначала обновляем версию локально, тестируем. Фиксируем изменения всех зависимостей командой:
`pip freeze > requirements.txt`

## Обновляем Ubuntu на сервере
1. Проверим версию Ubuntu: `cat /etc/*release`
2. Обновим систему и пакеты в ней: `sudo apt update && sudo apt upgrade -y`

## Обновляем python на сервере
1. Проверить версию: `python3 -V`
2. Если сразу запустить обновление, то возникнет ошибка:
```
sudo apt install python3.10
Чтение списков пакетов… Готово
Построение дерева зависимостей
Чтение информации о состоянии… Готово
E: Невозможно найти пакет python3.10
E: Не удалось найти ни один пакет с помощью шаблона «python3.10»
```
3. Сначала установим необходимые компоненты для добавления пользовательских PPA: 
`sudo apt install software-properties-common -y`
4. Добавим PPA-репозиторий deadsnakes/ppa в список источников диспетчера пакетов APT:
`sudo add-apt-repository ppa:deadsnakes/ppa -y`
5. Запустим обновление APT для обновления менеджера пакетов — появится новый импортированный PPA: `sudo apt update`
6. Теперь можем установить новую версию python 3.10: `sudo apt install python3.10`
7. Проверим установленную версию: `python3.10 --version`
8. Также проверим текущую версию по умолчанию: `python3 -V`
9. Установим дополнительные модули стандартной библиотеки (venv): `sudo apt install python3.10-venv -y`
10. Для расширений C: `sudo apt install python3.10-dev -y`
11. Также могут пригодиться и другие модули:
```
sudo apt install python3.10-distutils -y
sudo apt install python3.10-lib2to3 -y
sudo apt install python3.10-gdbm -y
sudo apt install python3.10-tk -y
```
12. Многие дополнительные модули python нужны для работы библиотек, без них они не установятся и будут вылезать ошибки.

## Меняем версию python в системе «по умолчанию»
1. По умолчанию python будет указывать на старую версию.  Например, Python 3 указывает на Python 3.8. Это значит,
что когда мы запустим python3, он будет выполняться как python 3.8, мы же хотим выполнить его как python 3.10.
Для этого добавим альтернативы:
```
sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.8 1
sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.10 2
```
2. Выберем нужную сборку: `sudo update-alternatives --config python3`

## Устанавливаем новое окружение
1. Переименовываем старую директорию окружения (мы должны находится в директории сайта с виртуальным окружением):
`mv venv venv-old-python-3.8`
2. Затем в этой директории создаем новое виртуальное окружение: `python3 -m venv venv`
3. Подтягиваем изменения: `git pull`
4. Активируем оболочку: `source venv/bin/activate`
5. Установим зависимости:
```
pip install --upgrade pip
pip install -r requirements.txt
```